<!DOCTYPE html>
<html>

<head>
    <link rel="icon" type="image/png" href="/favicon.png">
    <script async src="build/dist/prebid.js"></script>
    <meta charset="utf-8" />
    <title>Prebid Video -- video.js</title>
  
    <script type="text/javascript" src="https://static.adplayer.pro/player/demo.js"></script>

    <script>
        var pbjs = pbjs || {};
        pbjs.que = pbjs.que || [];
        var tempTag = false;
        var invokeVideoPlayer = function(url) {
            tempTag = url;
        }

        /* Prebid video ad unit */

        var videoAdUnit = {
            code: 'video1',
            sizes: [640,480],
            mediaTypes: { video: {context: 'instream', //or 'outstream'
                    playerSize: [[640, 480]],
                    skipppable: true,
                    minduration: 5,
                    maxduration: 45,
                    playback_method: ['auto_play_sound_off', 'viewport_sound_off'],
                    mimes: ["application/javascript",
                        "video/mp4"],

                } },
            bids: [
                {
                    bidder: 'districtmDMX',
                    params: {
                        dmxid: '250258',
                        memberid: '100600',
                    }
                },
                {
                    bidder: 'appnexus',
                    params: {
                        placementId: 1999857,
                        video: {
                            id: 123,
                            skipppable: true,
                            playback_method: ['auto_play_sound_off']
                        }
                    }
                }
            ]
        };

        pbjs.que.push(function() {
            pbjs.addAdUnits(videoAdUnit);

            pbjs.setConfig({
                debug: true,
                cache: {
                    url: 'https://prebid.adnxs.com/pbc/v1/cache'
                },
                userSync: {
                    userIds: [{
                        name: "id5Id",
                        params: {
                            partner: 173,
                            pd: "vsnvlskdvnslivsnlvinsilvnsvsnvisvsivn"
                        },
                        storage: {
                            type: "cookie",
                            name: "id5id.1st",       // create a cookie with this name
                            expires: 90,             // cookie lasts for 90 days
                            refreshInSeconds: 8*3600 // refresh ID every 8 hours to ensure it is fresh
                        }
                    }],
                    auctionDelay: 50
                }
            });
            pbjs.requestBids({
                bidsBackHandler: function(bids) {
                    console.log(bids)
                    var videoUrl = pbjs.adServers.dfp.buildVideoUrl({
                        adUnit: videoAdUnit,
                        params: {
                            iu: '/191956889/demo-video',
                            cust_params: {
                                section: 'blog',
                                anotherKey: 'anotherValue'
                            },
                            output: 'vast'
                        }
                    });
                    invokeVideoPlayer(videoUrl);
                }
            });
        });

    </script>
</head>

<body>

<h2>Prebid Video -- video.js</h2>


<div id="playerContainerADP" style="width:640px; height:480px;"></div>
<script type="text/javascript">
    invokeVideoPlayer = function(url) {
        AdPlayerPro('playerContainerADP').setup({
            "file": "https://static.adplayer.pro/video/640.mp4",
            "width": 640,
            "height": 480,
            "autoStart": true,
            "muted": true,
            "advertising": {
                "tag": url
            }
        });
    };

    if (tempTag) {
        invokeVideoPlayer(tempTag);
        tempTag = false;
    }
</script>

</body>

</html>
